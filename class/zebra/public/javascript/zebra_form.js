(function(a){a.Zebra_DatePicker=function(r,A){var D={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],direction:0,disabled_dates:false,first_day_of_week:1,format:"Y-m-d",months:["January","February","March","April","May","June","July","August","September","October","November","December"],offset:[20,-5],readonly_element:true,show_week_number:false,view:"days",weekend_days:[0,6]};var c,C,p,f,G,b,l,j,u,g,s,t,I,k,x,z,L,N,o,H,n,K;var O=this;O.settings={};var e=a(r);var M=function(){O.settings=a.extend({},D,A);if(O.settings.readonly_element){e.attr("readonly","readonly")}c=O.settings.view;var S='<button type="button" class="Zebra_DatePicker_Icon">Pick a date</button>';p=a(S);O.icon=p;n=(!a.isArray(O.settings.direction)&&(O.settings.direction===true||m(O.settings.direction)>0))||(a.isArray(O.settings.direction)&&O.settings.direction.length==2&&(O.settings.direction[0]===true||m(O.settings.direction[0])>0))?true:(!a.isArray(O.settings.direction)&&(O.settings.direction===false||m(O.settings.direction)<0))||(a.isArray(O.settings.direction)&&O.settings.direction.length==2&&(O.settings.direction[0]===false||m(O.settings.direction[0])<0))?false:0;var R=new Date();s=R.getMonth();j=R.getMonth();t=R.getFullYear();u=R.getFullYear();I=R.getDate();g=R.getDate();if(n!==0){R=new Date(t,s,I+m(a.isArray(O.settings.direction)?O.settings.direction[0]:O.settings.direction));s=R.getMonth();t=R.getFullYear();I=R.getDate()}if(n!==0&&a.isArray(O.settings.direction)&&O.settings.direction.length==2){R=new Date(t,s,I+((n>0?1:-1)*m(O.settings.direction[1])));K=m(Q(R.getFullYear(),q(R.getMonth(),2),q(R.getDate(),2)))}if(J(Q(t,q(s,2),q(I,2)))){while(J(t)){if(!n){t--}else{t++}s=0}while(J(Q(t,q(s,2)))){if(!n){s--}else{s++}if(s>11){t++;s=0}else{if(s<0){t--;s=0}}I=1}while(J(Q(t,q(s,2),q(I,2)))){if(!n){I--}else{I++}R=new Date(t,s,I);t=R.getFullYear();s=R.getMonth();I=R.getDate()}}(O.settings.readonly_element?p.add(e):p).bind("click",function(U){U.preventDefault();if(C.css("display")!="none"){O.hide()}else{var T=h(e.val());if(T){L=T.getMonth();k=T.getMonth();N=T.getFullYear();x=T.getFullYear();z=T.getDate();if(J(Q(N,q(L,2),q(z,2)))){k=s;x=t}}else{k=s;x=t}F();O.show()}});p.insertAfter(r);var S='<div class="Zebra_DatePicker"><table class="dp_header"><tr><td class="dp_previous">&laquo;</td><td class="dp_caption">&nbsp;</td><td class="dp_next">&raquo;</td></tr></table><table class="dp_daypicker"></table><table class="dp_monthpicker"></table><table class="dp_yearpicker"></table></div>';C=a(S);O.datepicker=C;f=C.find("table.dp_header").first();G=C.find("table.dp_daypicker").first();b=C.find("table.dp_monthpicker").first();l=C.find("table.dp_yearpicker").first();a("body").append(C);C.delegate("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked, .dp_week_number)","mouseover",function(){a(this).addClass("dp_hover")}).delegate("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked, .dp_week_number)","mouseout",function(){a(this).removeClass("dp_hover")});i(f.find("td"));f.find(".dp_previous").bind("click",function(){if(!a(this).hasClass("dp_blocked")){if(c=="months"){x--}else{if(c=="years"){x-=12}else{if(--k<0){k=11;x--}}}F()}});f.find(".dp_caption").bind("click",function(){if(c=="days"){c="months"}else{if(c=="months"){c="years"}else{c="days"}}F()});f.find(".dp_next").bind("click",function(){if(!a(this).hasClass("dp_blocked")){if(c=="months"){x++}else{if(c=="years"){x+=12}else{if(++k==12){k=0;x++}}}F()}});G.delegate("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_week_number)","click",function(){e.val(B(new Date(x,k,m(a(this).html()))));O.hide()});b.delegate("td:not(.dp_disabled)","click",function(){var T=a(this).attr("class").match(/dp\_month\_([0-9]+)/);k=m(T[1]);c="days";F()});l.delegate("td:not(.dp_disabled)","click",function(){x=m(a(this).html());c="months";F()});a(document).bind({mousedown:O._mousedown,keyup:O._keyup});o=[];a.each(O.settings.disabled_dates,function(){var X=this.split(" ");for(var W=0;W<4;W++){if(!X[W]){X[W]="*"}X[W]=(a.inArray(",",X[W])>-1?X[W].split(","):new Array(X[W]));for(var V=0;V<X[W].length;V++){if(a.inArray("-",X[W][V])>-1){var U=X[W][V].match(/^([0-9]+)\-([0-9]+)/);if(null!=U){for(var T=m(U[1]);T<=m(U[2]);T++){if(a.inArray(T,X[W])==-1){X[W].push(T+"")}}X[W].splice(V,1)}}}for(V=0;V<X[W].length;V++){X[W][V]=(isNaN(m(X[W][V]))?X[W][V]:m(X[W][V]))}}o.push(X)})};O.hide=function(){E("hide");C.css("display","none")};O.show=function(){F();var Y=C.outerWidth(),X=C.outerHeight(),W=p.offset().left+O.settings.offset[0],V=p.offset().top-X+O.settings.offset[1],R=a(window).width(),U=a(window).height(),T=a(window).scrollTop(),S=a(window).scrollLeft();if(W+Y>S+R){W=S+R-Y}if(W<S){W=S}if(V+X>T+U){V=T+U-X}if(V<T){V=T}C.css({left:W,top:V});C.fadeIn(a.browser.msie&&a.browser.version.match(/^[6-8]/)?0:150,"linear");E()};var h=function(V){if(a.trim(V)!=""){var ae=y(O.settings.format.replace(/\s/g,"")),ad=["d","D","j","l","N","S","w","F","m","M","n","Y","y"],Z=new Array,ac=new Array;for(var Y=0;Y<ad.length;Y++){if((position=ae.indexOf(ad[Y]))>-1){Z.push({character:ad[Y],position:position})}}Z.sort(function(ag,af){return ag.position-af.position});a.each(Z,function(ag,af){switch(af.character){case"d":ac.push("0[1-9]|[12][0-9]|3[01]");break;case"D":ac.push("[a-z]{3}");break;case"j":ac.push("[1-9]|[12][0-9]|3[01]");break;case"l":ac.push("[a-z]+");break;case"N":ac.push("[1-7]");break;case"S":ac.push("st|nd|rd|th");break;case"w":ac.push("[0-6]");break;case"F":ac.push("[a-z]+");break;case"m":ac.push("0[1-9]|1[012]+");break;case"M":ac.push("[a-z]{3}");break;case"n":ac.push("[1-9]|1[012]");break;case"Y":ac.push("[0-9]{4}");break;case"y":ac.push("[0-9]{2}");break}});if(ac.length){Z.reverse();a.each(Z,function(ag,af){ae=ae.replace(af.character,"("+ac[ac.length-ag-1]+")")});ac=new RegExp("^"+ae+"$","ig");if((segments=ac.exec(V.replace(/\s/g,"")))){var T,S,ab,aa=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],X=["January","February","March","April","May","June","July","August","September","October","November","December"],U,R=true;Z.reverse();a.each(Z,function(ag,af){if(!R){return true}switch(af.character){case"m":case"n":S=m(segments[ag+1]);break;case"d":case"j":T=m(segments[ag+1]);break;case"D":case"l":case"F":case"M":if(af.character=="D"||af.character=="l"){U=O.settings.days}else{U=O.settings.months}R=false;a.each(U,function(ah,ai){if(R){return true}if(segments[ag+1].toLowerCase()==ai.substring(0,(af.character=="D"||af.character=="M"?3:ai.length)).toLowerCase()){switch(af.character){case"D":segments[ag+1]=aa[ah].substring(0,3);break;case"l":segments[ag+1]=aa[ah];break;case"F":segments[ag+1]=X[ah];S=ah+1;break;case"M":segments[ag+1]=X[ah].substring(0,3);S=ah+1;break}R=true}});break;case"Y":ab=m(segments[ag+1]);break;case"y":ab="19"+m(segments[ag+1]);break}});if(R){var W=new Date(ab,S-1,T);if(W.getFullYear()==ab&&W.getDate()==T&&W.getMonth()==(S-1)){return W}}}}return false}};var i=function(R){if(a.browser.mozilla){R.css("MozUserSelect","none")}else{if(a.browser.msie){R.bind("selectstart",function(){return false})}else{R.mousedown(function(){return false})}}};var y=function(R){return R.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")};var B=function(S){var aa="",V=S.getDate(),Z=S.getDay(),T=O.settings.days[Z],R=S.getMonth()+1,X=O.settings.months[R-1],Y=S.getFullYear()+"";for(var W=0;W<O.settings.format.length;W++){var U=O.settings.format.charAt(W);switch(U){case"y":Y=Y.substr(2);case"Y":aa+=Y;break;case"m":R=q(R,2);case"n":aa+=R;break;case"M":X=X.substr(0,3);case"F":aa+=X;break;case"d":V=q(V,2);case"j":aa+=V;break;case"D":T=T.substr(0,3);case"l":aa+=T;break;case"N":Z++;case"w":aa+=Z;break;case"S":if(V%10==1&&V!="11"){aa+="st"}else{if(V%10==2&&V!="12"){aa+="nd"}else{if(V%10==3&&V!="13"){aa+="rd"}else{aa+="th"}}}break;default:aa+=U}}return aa};var w=function(){var V=new Date(x,k+1,0).getDate(),U=new Date(x,k,1).getDay(),X=new Date(x,k,0).getDate(),T=U-O.settings.first_day_of_week;T=T<0?7+T:T;P(O.settings.months[k]+", "+x);var Y="<tr>";if(O.settings.show_week_number){Y+="<th>"+O.settings.show_week_number+"</th>"}for(var W=0;W<7;W++){Y+="<th>"+O.settings.days[(O.settings.first_day_of_week+W)%7].substr(0,2)+"</th>"}Y+="</tr><tr>";for(var W=0;W<42;W++){if(W>0&&W%7==0){Y+="</tr><tr>"}if(W%7==0&&O.settings.show_week_number){var aa=new Date(x,0,1),S=new Date(x,k,W),ab=Math.ceil((((S-aa)/86400000)+S.getDay()+1)/7);Y+='<td class="dp_week_number">'+ab+"</td>"}var ac=(W-T+1);if(W<T){Y+='<td class="dp_not_in_month">'+(X-T+W+1)+"</td>"}else{if(ac>V){Y+='<td class="dp_not_in_month">'+(ac-V)+"</td>"}else{var Z=(O.settings.first_day_of_week+W)%7,R=m(Q(x,q(k,2),q(ac,2)));class_name="";if(J(R)||(undefined!=K&&((O.settings.direction[0]>0&&R>K)||(O.settings.direction[0]<=0&&R<K)))){if(a.inArray(Z,O.settings.weekend_days)>-1){class_name="dp_weekend_disabled"}else{class_name+=" dp_disabled"}}else{if(a.inArray(Z,O.settings.weekend_days)>-1){class_name="dp_weekend"}if(k==L&&x==N&&z==ac){class_name+=" dp_selected"}else{if(k==j&&x==u&&g==ac){class_name+=" dp_current"}}}Y+="<td"+(class_name!=""?' class="'+a.trim(class_name)+'"':"")+">"+q(ac,2)+"</td>"}}}Y+="</tr>";G.html(a(Y));G.css("display","")};var d=function(){P(x);var T="<tr>";for(var S=0;S<12;S++){if(S>0&&S%3==0){T+="</tr><tr>"}var U="dp_month_"+S,R=m(Q(x,q(S,2)));if(J(R)){U+=" dp_disabled"}else{if(j==S&&u==x){U+=" dp_current"}}T+='<td class="'+a.trim(U)+'">'+O.settings.months[S].substr(0,3)+"</td>"}T+="</tr>";b.html(a(T));b.css("display","")};var v=function(){P(x-7+" - "+(x+4));var T="<tr>";for(var S=0;S<12;S++){if(S>0&&S%3==0){T+="</tr><tr>"}var U="",R=m(x-7+S);if(J(R)){U+=" dp_disabled"}else{if(u==(x-7+S)){U+=" dp_current"}}T+="<td"+(a.trim(U)!=""?' class="'+a.trim(U)+'"':"")+">"+(x-7+S)+"</td>"}T+="</tr>";l.html(a(T));l.css("display","")};var E=function(R){if(a.browser.msie&&a.browser.version.match(/^6/)){if(!H){var T=m(C.css("zIndex"))-1;H=jQuery("<iframe>",{src:'javascript:document.write("")',scrolling:"no",frameborder:0,allowtransparency:"true",css:{zIndex:T,position:"absolute",top:-1000,left:-1000,width:C.outerWidth(),height:C.outerHeight(),filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)",display:"none"}});a("body").append(H)}switch(R){case"hide":H.css("display","none");break;default:var S=C.offset();H.css({top:S.top,left:S.left,display:"block"})}}};var J=function(T){if(n!==0){var R=(T+"").length;if(R==8&&((n&&T<Q(t,q(s,2),q(I,2)))||(!n&&T>Q(t,q(s,2),q(I,2))))){return true}else{if(R==6&&((n&&T<Q(t,q(s,2)))||(!n&&T>Q(t,q(s,2))))){return true}else{if(R==4&&((n&&T<t)||(!n&&T>t))){return true}}}}if(o){T=T+"";var V=m(T.substr(0,4)),W=m(T.substr(4,2))+1,S=m(T.substr(6,2)),U=false;a.each(o,function(){if(U){return}var Y=this;if(a.inArray(V,Y[2])>-1||a.inArray("*",Y[2])>-1){if((undefined!=W&&a.inArray(W,Y[1])>-1)||a.inArray("*",Y[1])>-1){if((undefined!=S&&a.inArray(S,Y[0])>-1)||a.inArray("*",Y[0])>-1){if(Y[3]=="*"){return(U=true)}var X=new Date(V,W-1,S).getDay();if(a.inArray(X,Y[3])>-1){return(U=true)}}}}});if(U){return true}}return false};var P=function(R){f.find(".dp_caption").html(R);if(n!==0){var S=x,U=k,T;if(c=="days"){if(n&&--U<0){U=11;S--}else{if(!n&&++U>11){U=0;S++}}T=Q(S,q(U,2))}else{if(c=="months"){if(n){S--}else{S++}T=S}else{if(c=="years"){if(n){S-=7}else{S+=7}T=S}}}if(J(T)){f.find(n?".dp_previous":".dp_next").addClass("dp_blocked");f.find(n?".dp_previous":".dp_next").removeClass("dp_hover")}else{f.find(n?".dp_previous":".dp_next").removeClass("dp_blocked")}}};var F=function(){if(G.text()==""||c=="days"){if(G.text()==""){C.css({left:-1000,display:"block"});w();var S=G.outerWidth(),R=G.outerHeight();f.css("width",S);b.css({width:S,height:R});l.css({width:S,height:R});C.css({display:"none"})}else{w()}b.css("display","none");l.css("display","none")}else{if(c=="months"){d();G.css("display","none");l.css("display","none")}else{if(c=="years"){v();G.css("display","none");b.css("display","none")}}}};var q=function(S,R){S+="";while(S.length<R){S="0"+S}return S};var Q=function(){var S="";for(var R=0;R<arguments.length;R++){S+=(arguments[R]+"")}return S};var m=function(R){return parseInt((R===true||R===false?0:R),10)};O._keyup=function(R){if(C.css("display")=="block"||R.which==27){O.hide()}return true};O._mousedown=function(R){if(C.css("display")=="block"){if(a(R.target).get(0)===p.get(0)){return true}if(a(R.target).parents().filter(".Zebra_DatePicker").length==0){O.hide()}}return true};M()};a.fn.Zebra_DatePicker=function(b){return this.each(function(){if(undefined!=a(this).data("Zebra_DatePicker")){var c=a(this).data("Zebra_DatePicker");c.icon.remove();c.datepicker.remove();a(document).unbind("keyup",c._keyup);a(document).unbind("mousedown",c._mousedown)}var c=new a.Zebra_DatePicker(this,b);a(this).data("Zebra_DatePicker",c)})}})(jQuery);(function(a){a.Zebra_Form=function(l,r){var n=this;var h={scroll_to_error:true,tips_position:"left",close_tips:true,assets_path:null};n.settings={};var p=new Object,g=new Object,i=new Object,o=new Array,b=false;var q=a(l),f=l;n.filter_input=function(x,A,w){var y,z,v,s="";var u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var t="0123456789";if(window.event){y=window.event.keyCode;A=window.event}else{if(A){y=A.which}else{return true}}switch(x){case"alphabet":s=u;break;case"digits":case"number":case"float":s=t;break;case"alphanumeric":s=u+t;break;default:return true}if(w){s+=w}v=A.srcElement?A.srcElement:A.target||A.currentTarget;if(y==null||y==0||y==8||y==9||y==13||y==27){return true}z=String.fromCharCode(y);if(s.indexOf(z)>-1){return true}if(x=="number"&&z=="-"&&k(v)==0){return true}if(x=="float"&&((z=="-"&&k(v)==0)||(z=="."&&k(v)!=0&&v.value.match(/\./)==null))){return true}return false};n.init=function(){n.settings=a.extend({},h,r);q.find("option.dummy").remove();q.find("div.error").each(function(){var u=a(this),t=u.first("div.close a");t.click(function(v){v.preventDefault();u.animate({height:0,opacity:0},250,function(){u.remove()})})});var s=q.find(".control");s.each(function(){var v=a(this),u={id:v.attr("id"),type:j(v)},w=v.closest(".row");if(w.length){v.bind({focus:function(){w.addClass("highlight")},blur:function(){w.removeClass("highlight")}})}if(v.hasClass("inner-label")&&(u.type=="text"||u.type=="password"||u.type=="textarea")){var t=v.offset(),x=jQuery("<span>").attr({"class":"Zebra_Form_Placeholder"}).css({display:"none",left:t.left,top:t.top}).html(u.type=="text"||u.type=="password"?v.attr("alt"):v.attr("title")).appendTo(document.body);v.removeAttr("title");x.bind("click",function(){v.focus()});v.bind({focus:function(){x.css("display","none")},blur:function(){if(v.val()==""){x.css("display","block")}}});a(window).bind("resize",function(){t=v.offset();x.css({left:t.left,top:t.top})});v.data("Zebra_Form_Placeholder",x);o.push(v)}else{if(v.hasClass("other")&&u.type=="select-one"){d(v);v.change(function(){d(v)})}}if(undefined!=n.settings.error_messages&&undefined!=typeof n.settings.error_messages[u.id]){n.register(v,false)}});q.bind("submit",function(t){if(b==false&&undefined!=n.settings.error_messages){if(!n.validate()){if(undefined!=t){t.preventDefault()}n.show_errors()}else{if(undefined==t){q.submit()}}}});setTimeout(e,50)};n.attach_tip=function(s,t){var u=a("#"+s).attr("id");p[u].message=t;n.show_errors(s)};n.clear_errors=function(){a(".Zebra_Form_error_iFrameShim").remove();a(".Zebra_Form_error_message").remove();i=[]};n.end_file_upload=function(v,u){var s=a("#"+v);if(s.length){n.clear_errors();q.removeAttr("target");var y=v;a("#"+y+"_iframe").remove();a("#"+y+"_spinner").remove();if(undefined!=p[v]){if(undefined!=u&&"object"==typeof(u)&&undefined!=u[0]&&undefined!=u[1]&&undefined!=u[2]&&undefined!=u[3]){s.data("file_info",u)}if(true!==n.validate_control(s)){s.val("");s.css("opacity","1");n.show_errors(s)}else{var w=s.offset(),x=jQuery("<div>",{"class":"Zebra_Form_filename",css:{left:w.left,top:w.top,width:s.outerWidth,opacity:0}}).html(u[0]),t=jQuery("<a>",{href:"javascript:void(0)"}).html("x").bind("click",function(z){z.preventDefault();x.remove();s.val("");if(s.data("file_info")){s.removeData("file_info")}s.css("opacity",1)});a("body").append(x.append(t));x.css({top:parseInt(x.css("top"),10)+((s.outerHeight()-x.outerHeight())/2),opacity:1})}}}};n.hide_error=function(t){var s=i[t];if(undefined!=s){s.animate({opacity:0},250,function(){var u=s.data("shim");if(undefined!=u){u.remove()}s.remove();delete i[t]})}};n.register=function(w){var v={id:w.attr("id"),name:w.attr("name"),type:j(w)};v.name=v.name.replace(/\[\]$/,"");switch(v.type){case"radio":case"checkbox":w.bind({click:function(){n.hide_error(v.name)},blur:function(){n.hide_error(v.name)}});if(undefined==g[v.id]){g[v.id]=q.find("input[name^="+v.name+"]")}break;case"file":var y=w.clone(true);y.attr("value","");w.replaceWith(y);y.bind({keypress:function(D){D.preventDefault();y.attr("value","")},change:function(){n.hide_error(v.name);if(y.data("file_info")){y.removeData("file_info")}var D=jQuery("<iframe>",{src:"javascript:void(0)",id:v.id+"_iframe",name:v.id+"_iframe",scrolling:"no",marginwidth:0,marginheight:0,width:0,height:0,frameborder:0,allowTransparency:"true"});a("body").append(D);var G=q.attr("action");q.attr("action",n.settings.assets_path+"process.php?form="+q.attr("id")+"&control="+v.id+"&nocache="+new Date().getTime());q.attr("target",v.id+"_iframe");y.css("opacity",0);var F=y.offset(),E=jQuery("<div>",{id:v.id+"_spinner","class":"Zebra_Form_spinner",css:{left:F.left,top:F.top}});a("body").append(E);b=true;q.trigger("submit");q.attr("action",G);b=false},blur:function(){n.hide_error(v.name)}});w=y;break;case"select-one":case"select-multiple":w.bind({change:function(){n.hide_error(v.name)},blur:function(){n.hide_error(v.name)}});break;default:w.blur(function(){n.hide_error(v.name)})}var C=w.attr("class").match(/validate\[(.+)\]/);if(null!=C){var A=/([^\,]*\(.*?\)|[^\,]+)/g,x=new Object;while(matches=A.exec(C[1])){var z=matches[1].match(/^([^\(]+)/),u=matches[1].match(/\((.*?)\)/);if(u){u=u[1].split(",");a.each(u,function(D){u[D]=u[D].replace(/lsqb\;/g,"[");u[D]=u[D].replace(/rsqb\;/g,"]");u[D]=u[D].replace(/comma\;/g,",");u[D]=u[D].replace(/lsb\;/g,"(");u[D]=u[D].replace(/rsb\;/g,")")})}else{u=null}x[z[1]]=u}if(undefined==arguments[1]){var s=q.find(".control");a.each(s,function(E,H){if(H==w.get(0)){var H=a(H),I=null,D=E-1;while(I==null&&undefined!=s[D]){I=a(s[D]).attr("id");D--}if(!p[I]){var G=new Object;G[v.id]={element:w,rules:x};a.extend(p,G)}else{var F=new Object;for(E in p){F[E]=p[E];if(I==E){F[v.id]={element:w,rules:x}}}p=F}}})}else{if(undefined!=arguments[1]&&a("#"+arguments[1]).length){var t=a("#"+arguments[1]).attr("id"),B=new Object;for(index in p){B[index]=p[index];if(previous_element_id==index){B[v.id]={element:w,rules:x}}}p=B}else{if(undefined!=arguments[1]&&arguments[1]===false){p[v.id]={element:w,rules:x}}}}}};n.show_errors=function(){n.clear_errors();var s=0;for(index in p){var v=p[index],A=v.element,z={id:A.attr("id"),name:A.attr("name"),type:j(A)};z.name=z.name.replace(/\[\]$/,"");if(undefined!=arguments[0]&&arguments[0].get(0)!=A.get(0)){continue}if(undefined!=v.message){if(A.css("display")!="none"){A.focus()}var y=a.extend(A.offset());y=a.extend(y,{right:Math.floor(y.left+A.width())});var t=jQuery("<div/>",{"class":"Zebra_Form_error_message",css:{opacity:0}}),F=jQuery("<div/>",{"class":"message"+(!n.settings.close_tips?" noclose":""),css:{width:"auto"}}).html(v.message).appendTo(t);if(n.settings.close_tips){var E=jQuery("<a/>",{href:"javascript:void(0)","class":"close"+(a.browser.msie&&a.browser.version.match(/^6/)?"-ie6":"")}).html("x").bind({click:function(G){G.preventDefault();n.hide_error(z.name)},focus:function(){E.blur()}}).appendTo(F)}var D=jQuery("<div/>",{"class":"arrow"}).appendTo(t);a("body").append(t);var B={x:t.outerWidth(),y:t.outerHeight()},x={x:D.outerWidth(),y:D.outerHeight()},w=(n.settings.tips_position=="left"?y.left:y.right)-(B.x/2);D.css("left",(B.x/2)-(x.x/2)-1);if(z.type=="radio"||z.type=="checkbox"){w=y.right-(B.x/2)-(A.outerWidth()/2)+1}if(w<0){w=2}t.css("left",w);B={x:t.outerWidth(),y:t.outerHeight()};var C=(y.top-B.y+(x.y/2)-1);if(C<0){C=2}t.css({left:w+"px",top:C+"px",height:(B.y-(x.y/2))+"px"});var u=(z.type=="radio"||z.type=="checkbox"?z.name:z.id);i[u]=t;c(t);t.animate({opacity:0.9},250);if(++s==1&&n.settings.scroll_to_error){a("html, body").animate({scrollTop:t.css("top").replace(/px/,"")-10},250)}break}}};n.submit=function(){if(undefined!=n.settings.error_messages){q.trigger("submit")}else{f.submit()}};n.validate_control=function(v){var D={id:v.attr("id"),type:j(v)},S=true,N=p[D.id];if(undefined!=N&&v.css("display")!="none"&&v.css("visibility")!="hidden"){var H=null,R=null;delete N.message;for(var z in N.rules){if(!S){break}switch(z){case"alphabet":switch(D.type){case"password":case"text":case"textarea":var C=new RegExp("^[a-z"+m(N.rules[z][0]).replace(/\s/,"\\s")+"]+$","ig");if(a.trim(v.val())!=""&&!C.test(v.val())){S=false}break}break;case"alphanumeric":switch(D.type){case"password":case"text":case"textarea":var C=new RegExp("^[a-z0-9"+m(N.rules[z][0]).replace(/\s/,"\\s")+"]+$","ig");if(a.trim(v.val())!=""&&!C.test(v.val())){S=false}break}break;case"compare":switch(D.type){case"password":case"text":case"textarea":if(!a("#"+N.rules[z][0])||v.val()!=a("#"+N.rules[z][0]).val()){S=false}break}break;case"custom":var E=false;a.each(N.rules[z],function(W,V){if(E){return}V=a.map(V.split(","),function(Y){return Y.replace(/mark\;/g,",")});V=a.merge(a.merge([V.shift()],[v.val()]),V);var X=(typeof V[0]=="function")?V[0]:(typeof window[V[0]]=="function"?window[V[0]]:false);if(X!==false){S=X.apply(X,V.slice(1))}else{S=false;throw new Error('Function "'+V[0]+"\" doesn't exist!")}if(!S){R=V[0];E=true}});break;case"date":switch(D.type){case"text":if(a.trim(v.val())!=""){var B=false,M=v.data("Zebra_DatePicker").settings.format.replace(/\s/g,""),T=["d","D","j","l","N","S","w","F","m","M","n","Y","y","G","H","g","h","a","A","i","s","U"],s=new Array,U=new Array;M=m(M);for(var L=0;L<T.length;L++){if((position=M.indexOf(T[L]))>-1){s.push({character:T[L],position:position})}}s.sort(function(W,V){return W.position-V.position});a.each(s,function(W,V){switch(V.character){case"d":U.push("0[1-9]|[12][0-9]|3[01]");break;case"D":U.push("[a-z]{3}");break;case"j":U.push("[1-9]|[12][0-9]|3[01]");break;case"l":U.push("[a-z]+");break;case"N":U.push("[1-7]");break;case"S":U.push("st|nd|rd|th");break;case"w":U.push("[0-6]");break;case"F":U.push("[a-z]+");break;case"m":U.push("0[1-9]|1[012]+");break;case"M":U.push("[a-z]{3}");break;case"n":U.push("[1-9]|1[012]");break;case"Y":U.push("[0-9]{4}");break;case"y":U.push("[0-9]{2}");break;case"G":case"H":case"g":case"h":U.push("[0-9]{1,2}");break;case"a":case"A":U.push("(am|pm)");break;case"i":case"s":U.push("[012345][0-9]");break}});if(U.length>0){s.reverse();a.each(s,function(W,V){M=M.replace(V.character,"("+U[U.length-W-1]+")")});U=new RegExp("^"+M+"$","ig");if((segments=U.exec(v.val().replace(/\s/g,"")))){var x=null,K=null,u=null,y=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],Q=null,I=true;s.reverse();a.each(s,function(W,V){if(!I){return true}switch(V.character){case"m":case"n":K=parseInt(segments[W+1],10);break;case"d":case"j":x=parseInt(segments[W+1],10);break;case"D":case"l":case"F":case"M":if(V.character=="D"||V.character=="l"){Q=v.data("Zebra_DatePicker").settings.days}else{Q=v.data("Zebra_DatePicker").settings.months}I=false;a.each(Q,function(X,Y){if(I){return true}if(segments[W+1].toLowerCase()==Y.substring(0,(V.character=="D"||V.character=="M"?3:Y.length)).toLowerCase()){switch(V.character){case"D":segments[W+1]=y[X].substring(0,3);break;case"l":segments[W+1]=y[X];break;case"F":segments[W+1]=t[X];K=X+1;break;case"M":segments[W+1]=t[X].substring(0,3);K=X+1;break}I=true}});break;case"Y":u=parseInt(segments[W+1],10);break;case"y":u="19"+parseInt(segments[W+1],10);break}});if(I){var P=new Date(u,K-1,x);if(P.getFullYear()==u&&P.getDate()==x&&P.getMonth()==(K-1)){v.data("timestamp",Date.parse(t[K-1]+" "+x+", "+u));B=true}}}}if(!B){S=false}}break}break;case"datecompare":switch(D.type){case"password":case"text":case"textarea":if(undefined!=N.rules[z][0]&&undefined!=N.rules[z][1]&&a(N.rules[z][0])&&n.validate_control(a(N.rules[z][0]))===true&&undefined!=v.data("timestamp")){switch(N.rules[z][1]){case">":S=(v.data("timestamp")>a("#"+N.rules[z][0]).data("timestamp"));break;case">=":S=(v.data("timestamp")>=a("#"+N.rules[z][0]).data("timestamp"));break;case"<":S=(v.data("timestamp")<a("#"+N.rules[z][0]).data("timestamp"));break;case"<=":S=(v.data("timestamp")<=a("#"+N.rules[z][0]).data("timestamp"));break}}else{S=false}break}break;case"digits":switch(D.type){case"password":case"text":case"textarea":var C=new RegExp("^[0-9"+m(N.rules[z][0]).replace(/\s/,"\\s")+"]+$","ig");if(a.trim(v.val())!=""&&!C.test(v.val())){S=false}break}break;case"email":switch(D.type){case"password":case"text":case"textarea":if(a.trim(v.val())!=""&&null==v.val().match(/^([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+@{1}([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+\.[A-Za-z0-9]{2,}$/)){S=false}break}break;case"emails":switch(D.type){case"password":case"text":case"textarea":var w=v.val().split(",");w.each(function(V){if(a.trim(V)!=""&&null==a.trim(V).match(/^([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+@{1}([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+\.[A-Za-z0-9]{2,}$/)){S=false}});break}break;case"filesize":switch(D.type){case"file":var O=v.data("file_info");if(O){if(undefined==O[2]||undefined==O[3]||O[2]!=0||parseInt(O[3],10)>parseInt(N.rules[z][0],10)){S=false}}break}break;case"filetype":switch(D.type){case"file":var O=v.data("file_info");if(O){if(undefined==n.mimes){a.ajax({url:n.settings.assets_path+"mimes.json",async:false,success:function(V){n.mimes=V},dataType:"json"})}var J=a.map(N.rules[z][0].split(","),function(V){return a.trim(V)}),G=[];a.each(n.mimes,function(W,V){if(a.isArray(V)&&a.inArray(O[1],V)>-1||!a.isArray(V)&&V==O[1]){G.push(W)}});var F=false;a.each(G,function(V,W){if(a.inArray(W,J)>-1){F=true}});if(!F){S=false}}break}break;case"float":switch(D.type){case"password":case"text":case"textarea":var C=new RegExp("^[0-9-."+m(N.rules[z][0]).replace(/\s/,"\\s")+"]+$","ig");if(a.trim(v.val())!=""&&(a.trim(v.val())=="-"||a.trim(v.val())=="."||(null!=v.val().match(/\-/g)&&v.val().match(/\-/g).length>1)||(null!=v.val().match(/\./g)&&v.val().match(/\./g).length>1)||v.val().indexOf("-")>0||!C.test(v.val()))){S=false}break}break;case"image":switch(D.type){case"file":var O=v.data("file_info");if(O&&null==O[1].match(/image\/(gif|jpeg|png|pjpeg)/i)){S=false}break}break;case"length":switch(D.type){case"password":case"text":case"textarea":if(a.trim(v.val())!=""&&(undefined!=N.rules[z][0]&&a.trim(v.val()).length<N.rules[z][0])||(undefined!=N.rules[z][1]&&N.rules[z][1]>0&&v.val().length>N.rules[z][1])){S=false}break}break;case"number":switch(D.type){case"password":case"text":case"textarea":var C=new RegExp("^[0-9-"+m(N.rules[z][0]).replace(/\s/,"\\s")+"]+$","ig");if(a.trim(v.val())!=""&&(a.trim(v.val())=="-"||(null!=v.val().match(/\-/g)&&v.val().match(/\-/g).length>1)||v.val().indexOf("-")>0||!C.test(v.val()))){S=false}break}break;case"regexp":switch(D.type){case"password":case"text":case"textarea":var C=new RegExp(N.rules[z][0],"g");if(a.trim(v.val())!=""&&null==C.exec(v.val())){S=false}break}break;case"required":switch(D.type){case"checkbox":case"radio":var A=false;g[D.id].each(function(){if(this.checked){A=true}});if(!A){S=false}break;case"file":case"password":case"text":case"textarea":if(a.trim(v.val())==""){S=false}break;case"select-one":if((v.hasClass("other")&&v.val()=="other"&&(!a("#"+D.id+"_other").length||a.trim(a("#"+D.id+"_other").val())==""))||v.get(0).selectedIndex==0){S=false}break;case"select-multiple":if(v.get(0).selectedIndex==-1){S=false}break}break}if(!S){H=z;N.message=n.settings.error_messages[D.id][z=="custom"?"custom_"+R:H];N.value=v.val()}}}return(S?true:H)};n.validate=function(){var t=null,u=null,s=true;for(index in p){if(!s){break}l=p[index]["element"];u=l.attr("id");if((rule_not_passed=n.validate_control(l))!==true){s=false;break}}if(s&&undefined!=n.settings.onValid){return n.settings.onValid()}return s};var e=function(){a.each(o,function(){var s=a(this),t=s.data("Zebra_Form_Placeholder");if(s.val()==""&&!s.is(":focus")){t.css("display","block")}else{t.css("display","none")}});setTimeout(e,50)};var m=function(s){return s.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")};var k=function(t){if(t.selectionStart!=null){return t.selectionStart}var s=document.selection.createRange(),v=s.duplicate();if(t.type=="text"){return(0-v.moveStart("character",-100000))}else{var u=t.value,w=u.length;v.moveToElementText(t);v.setEndPoint("StartToStart",s);return w-v.text.length}};var c=function(s){if(a.browser.msie&&a.browser.version.match(/^6/)){if(!s.data("shim")){var t=s.offset(),v=parseInt(s.css("zIndex"),10)-1,u=jQuery("<iframe>",{src:'javascript:document.write("")',scrolling:"no",frameborder:0,allowTransparency:"true","class":"Zebra_Form_error_iFrameShim",css:{zIndex:v,position:"absolute",top:t.top,left:t.left,width:s.outerWidth(),height:s.outerHeight(),filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)",display:"block"}});a("body").append(u);s.data("shim",u)}}};var d=function(s){var t=a("#"+s.attr("id")+"_other");if(s.val()=="other"){t.css("display","block")}else{t.css("display","none")}};var j=function(t){var s=["button","input:checkbox","input:file","input:password","input:radio","input:submit","input:text","select","textarea"];for(index in s){if(t.is(s[index])){if(s[index]=="select"){if(t.attr("multiple")){return"select-multiple"}else{return"select-one"}}return s[index].replace(/input\:/,"")}}};n.init()};a.fn.Zebra_Form=function(b){return this.each(function(){var c=new a.Zebra_Form(this,b);a(this).data("Zebra_Form",c)})}})(jQuery);